<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>üêß northstar on linux | Sam  Bilbow</title>    
    <meta name="author" content="Sam  Bilbow">
    <meta name="description" content="towards an open-source workflow for AR musical instruments">
    <meta name="keywords" content="academic-website, portfolio-website, augmented-reality, music-technology">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:100,300,400,500,700%7CMaterial+Icons">
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&amp;display=swap" rel="stylesheet"> 
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet">
    

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="/assets/img/favicon.ico">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://sambilbow.com/blog/2023/north-star-on-linux/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/">Sam¬†Bilbow<span> </span><img class="rounded-circle" id="emoji" src="/assets/img/emoji/catsty.gif"></a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              
              <!-- Blog -->
              <li class="nav-item active">
                <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a>
              </li>

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">publications</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cv/">cv</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- _layouts/post.html -->

<div class="post">

  <header class="post-header">
    <h1 class="post-title">
<img id="emoji" src="/assets/img/emoji/collabora.png"> northstar on linux</h1>
    <p class="post-meta">April 12, 2023</p>
    <p class="post-tags">
      <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>
      ¬† ¬∑ ¬†
        <a href="/blog/tag/open-source">
          <i class="fas fa-hashtag fa-sm"></i> open-source</a> ¬†
          <a href="/blog/tag/linux">
          <i class="fas fa-hashtag fa-sm"></i> linux</a> ¬†
          <a href="/blog/tag/augmented-reality">
          <i class="fas fa-hashtag fa-sm"></i> augmented-reality</a> ¬†
          

    </p>
  </header>

  <article class="post-content">
    <h2 id="summary">Summary</h2>
<hr>
<p>The past few weeks have been spent getting familiar with a North Star (NS) headset workflow on Linux. As part of <a href="/projects/comuse/">CoMuse</a> I hope to move towards a fully open-source stack for multi-user musical AR experience. Here‚Äôs a bunch of instructions on how to get started with North Star on Linux. Instructions are for <a href="https://wiki.archlinux.org/" rel="external nofollow noopener" target="_blank">Arch-based systems</a>, e.g. <a href="https://endeavouros.com/" rel="external nofollow noopener" target="_blank">EndeavourOS</a>, and assumes a <a href="https://wiki.archlinux.org/title/wayland#Compositors" rel="external nofollow noopener" target="_blank">Wayland compositor</a>, rather than X11, e.g. <a href="https://community.kde.org/KWin/Wayland" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">kwin_wayland</code></a>. Also familiarity with a terminal emulator, e.g. <code class="language-plaintext highlighter-rouge">alacritty</code>.</p>

<p><strong>Current Windows Workflow</strong></p>

<p>North Star ‚Üí Project Esky ‚Üí Unity ‚Üí Unity Scene</p>

<p><strong>Proposed Linux Workflow</strong></p>

<p>North Star ‚Üí OpenXR ‚Üí Monado ‚Üí Application</p>

<p><br></p>

<h2 id="installation-for-robots">Installation for Robots</h2>
<hr>

<p>Hey there! If you‚Äôre feeling adventurous and trust me enough to run a bash script, then boy oh boy do I have a treat for you. I‚Äôve created a script that will get you started with North Star on Linux.</p>

<p>Now, I know what you‚Äôre thinking. ‚ÄúWhy on earth would I trust some random person on the internet with access to my terminal?‚Äù Well, let me tell you, friend. You can trust me because‚Ä¶ uh‚Ä¶ it was partially created by ChatGPT, a highly advanced, eloquent and benevolent artificial intelligence programmed to assist and guide humans with their tasks. ChatGPT is great, in fact, ChatGPT wrote this paragraph! So yeah, thats why you can trust <del>it</del> me‚Ä¶ Yeah, let‚Äôs go with that.</p>

<p>So, if you‚Äôre feeling stupid, go ahead and run this command in your terminal:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-sS</span> https://www.sambilbow.com/assets/code/ns-monado.sh | bash <span class="o">&amp;&amp;</span> leapctl eula
</code></pre></div></div>

<p>and skip to <a href="#getting-started">Getting Started</a></p>

<p><strong><em>I take no responsibility if your computer suddenly gains sentience and starts plotting world domination.</em></strong></p>

<p><br></p>

<h2 id="installation-for-humans">Installation for Humans</h2>
<hr>
<h3>
<img id="emoji" src="/assets/img/emoji/oxr.webp"> OpenXR (Open Standard XR API)</h3>

<p>Download, build, and install <code class="language-plaintext highlighter-rouge">openxr-git</code> from the <a href="https://aur.archlinux.org/packages/openxr-git" rel="external nofollow noopener" target="_blank">AUR</a>, i.e. <code class="language-plaintext highlighter-rouge">yay -S openxr-git</code></p>

<p><br></p>
<h3>
<img id="emoji" src="/assets/img/emoji/collabora.png"> Monado (OpenXR Runtime for GNU/Linux)</h3>

<p>Download, build, and install <code class="language-plaintext highlighter-rouge">monado-git</code> from the <a href="https://aur.archlinux.org/packages/monado-git" rel="external nofollow noopener" target="_blank">AUR</a>, i.e. <code class="language-plaintext highlighter-rouge">yay -S monado-git</code></p>

<p><br></p>
<h3>
<img id="emoji" src="/assets/img/emoji/ul_wave.webp"> Ultraleap (Hand Tracking)</h3>

<p>As written in the <a href="https://docs.ultraleap.com/linux/" rel="external nofollow noopener" target="_blank">Linux documentation</a>, Ultraleap have released their Gemini V5 tracking software as a beta for Ubuntu 22.04 LTS. However, the files are accessible via their repository for non-Debian Linux systems. I have created a <a href="https://aur.archlinux.org/packages/ultraleap-hand-tracking" rel="external nofollow noopener" target="_blank">meta-package <img id="emoji" src="/assets/img/emoji/arch.webp"></a> for all three required packages below on the <code class="language-plaintext highlighter-rouge">AUR</code>. It can be installed via <code class="language-plaintext highlighter-rouge">yay -S ultraleap-hand-tracking</code> and accepting default options when prompted.</p>

<p>Here are the individual packages, with links to their official Debian repository location, and their <code class="language-plaintext highlighter-rouge">AUR</code> counterpart:</p>
<ul>
  <li>
<a href="https://repo.ultraleap.com/apt/pool/main/u/ultraleap-hand-tracking-service/ultraleap-hand-tracking-service_5.6.3.0-18a4db52-1.0_amd64.deb" rel="external nofollow noopener" target="_blank"><img class="emoji" title=":arrow_down_small:" alt=":arrow_down_small:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f53d.png" height="20" width="20"></a> <a href="https://aur.archlinux.org/packages/ultraleap-hand-tracking-service" rel="external nofollow noopener" target="_blank"><img id="emoji" src="/assets/img/emoji/arch.webp"></a> <code class="language-plaintext highlighter-rouge">ultraleap-hand-tracking-service</code> - a background service that attaches to Ultraleap devices.</li>
  <li>
<a href="https://repo.ultraleap.com/apt/pool/main/u/ultraleap-hand-tracking-control-panel/ultraleap-hand-tracking-control-panel_684937.deb" rel="external nofollow noopener" target="_blank"><img class="emoji" title=":arrow_down_small:" alt=":arrow_down_small:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f53d.png" height="20" width="20"></a> <a href="https://aur.archlinux.org/packages/ultraleap-hand-tracking-control-panel" rel="external nofollow noopener" target="_blank"><img id="emoji" src="/assets/img/emoji/arch.webp"></a> <code class="language-plaintext highlighter-rouge">ultraleap-hand-tracking-control-panel</code> - a GUI application that shows cameras &amp; info.</li>
  <li>
<a href="https://repo.ultraleap.com/apt/pool/main/o/openxr-layer-ultraleap/openxr-layer-ultraleap_1.3.1_amd64.deb" rel="external nofollow noopener" target="_blank"><img class="emoji" title=":arrow_down_small:" alt=":arrow_down_small:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f53d.png" height="20" width="20"></a> <a href="https://aur.archlinux.org/packages/openxr-layer-ultraleap" rel="external nofollow noopener" target="_blank"><img id="emoji" src="/assets/img/emoji/arch.webp"></a> <code class="language-plaintext highlighter-rouge">openxr-layer-ultraleap</code> - an OpenXR layer that allows Ultraleap devices connect at the API layer.</li>
</ul>

<p>If you don‚Äôt want to use the <code class="language-plaintext highlighter-rouge">AUR</code>, unarchive the <code class="language-plaintext highlighter-rouge">.deb</code> from each repository, then do the same with the <code class="language-plaintext highlighter-rouge">data.tar.xz</code> inside (you can ignore <code class="language-plaintext highlighter-rouge">control.tar.xz</code>, this only contains meta-information about the package). Place all sub-directory files in their respective folders on your operating system using <code class="language-plaintext highlighter-rouge">sudo mv [file path] [destination path]</code>.</p>

<p>Run the following after installing, to enable the service at startup, and accept the Ultraleap EULA.</p>
<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl <span class="nb">enable </span>ultraleap-hand-tracking-service <span class="nt">--now</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
leapctl eula 
</code></pre></div></div>

<p><br></p>
<h3>
<img id="emoji" src="/assets/img/emoji/intel.png"> RealSense (6DoF Tracking)</h3>
<p>Download, build, and install <code class="language-plaintext highlighter-rouge">librealsense</code> and <code class="language-plaintext highlighter-rouge">libuvc</code> from the <a href="https://aur.archlinux.org/packages/librealsense" rel="external nofollow noopener" target="_blank">AUR</a>, i.e. <code class="language-plaintext highlighter-rouge">yay -S librealsense libuvc</code></p>

<p><br></p>
<h3>
<img id="emoji" src="/assets/img/emoji/arduino.png"> Arduino (Firmware)</h3>
<p>Download, build, and install <code class="language-plaintext highlighter-rouge">arduino</code> from the <code class="language-plaintext highlighter-rouge">community</code> repository, i.e. <code class="language-plaintext highlighter-rouge">yay -S arduino</code></p>

<p><br></p>

<h2 id="monado-configuration">Monado Configuration</h2>
<hr>
<ul>
  <li>
    <p>Make sure you Monado is set as your active OpenXR runtime. Check via the environment variable: <code class="language-plaintext highlighter-rouge">echo $XR_RUNTIME_JSON</code>. If there is no output, follow <a href="https://monado.freedesktop.org/getting-started.html#selecting-the-monado-runtime-for-openxr-applications" rel="external nofollow noopener" target="_blank">these</a> instructions.</p>
  </li>
  <li>
    <p>Set <code class="language-plaintext highlighter-rouge">~/.config/monado/config_v0.json</code> to the <a href="https://gist.github.com/sambilbow/3b7b257b535b3dd6fa7b53ad7e453ed0" rel="external nofollow noopener" target="_blank">following</a>:</p>
  </li>
</ul>
<div class="language-json highlighter-rouge" data-gist-url="https://gist.github.com/sambilbow/3b7b257b535b3dd6fa7b53ad7e453ed0">
<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
	</span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://monado.pages.freedesktop.org/monado/config_v0.schema.json"</span><span class="w">
</span><span class="p">}</span></code></pre></figure>
</div>

<ul>
  <li>Set <code class="language-plaintext highlighter-rouge">~/.config/monado/NorthStarCalibration.json</code> to the <a href="https://gist.github.com/sambilbow/91e1f794a6c757aa368c17ee8e01a20e" rel="external nofollow noopener" target="_blank">following</a>, replacing the <code class="language-plaintext highlighter-rouge">uv_to_rect</code> attributes with your own <a href="https://docs.projectnorthstar.org/calibration/2d-calibration" rel="external nofollow noopener" target="_blank">V2 calibration results</a>:</li>
</ul>
<div class="language-json highlighter-rouge" data-gist-url="https://gist.github.com/sambilbow/91e1f794a6c757aa368c17ee8e01a20e">
<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"baseline"</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w">
  </span><span class="nl">"left_fov_radians_left"</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"left_fov_radians_right"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"left_fov_radians_up"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"left_fov_radians_down"</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"right_fov_radians_left"</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"right_fov_radians_right"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"right_fov_radians_up"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"right_fov_radians_down"</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.8</span><span class="p">,</span><span class="w">
  </span><span class="nl">"t265"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"active"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"P_middleofeyes_to_trackingcenter_oxr"</span><span class="p">:{</span><span class="w">
      </span><span class="nl">"position"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"x"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">"y"</span><span class="p">:</span><span class="w"> </span><span class="mf">-0.04824</span><span class="p">,</span><span class="nl">"z"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.08609</span><span class="p">},</span><span class="w">
      </span><span class="nl">"orientation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"x"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.105</span><span class="p">,</span><span class="nl">"y"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="nl">"z"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="nl">"w"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.995</span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"left_uv_to_rect_x"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">-0.8095003898834657</span><span class="p">,</span><span class="w"> </span><span class="mf">1.4554106257653072</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.7773809977468603</span><span class="p">,</span><span class="w"> </span><span class="mf">0.36967403509293806</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1296775350969796</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.21637890025302492</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8416143930407659</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.5526095960484587</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.23531800162009645</span><span class="p">,</span><span class="w"> </span><span class="mf">1.143919902646346</span><span class="p">,</span><span class="w"> </span><span class="mf">-2.3456939620802744</span><span class="p">,</span><span class="w"> </span><span class="mf">1.460311705702624</span><span class="p">,</span><span class="w"> </span><span class="mf">0.014822777304581144</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.24003964060866342</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8664693244008452</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.5376673413826943</span><span class="p">],</span><span class="w"> 
  </span><span class="nl">"left_uv_to_rect_y"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">-0.46871202987411814</span><span class="p">,</span><span class="w"> </span><span class="mf">0.30170126370379197</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.47660532303616326</span><span class="p">,</span><span class="w"> </span><span class="mf">0.03431344082830879</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1429691076970927</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.8002538693210614</span><span class="p">,</span><span class="w"> </span><span class="mf">1.130777221567728</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.5460233471534343</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.46220913444061085</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9136086350468807</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.9560853146408843</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2520629301319113</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3998405266373577</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.771719042394445</span><span class="p">,</span><span class="w"> </span><span class="mf">1.4627736379425091</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.9364919387683032</span><span class="p">],</span><span class="w"> 
  </span><span class="nl">"right_uv_to_rect_x"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">-0.8756783654089152</span><span class="p">,</span><span class="w"> </span><span class="mf">1.8875569705203976</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.0087008718225396</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5130896252326521</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.03841362094642798</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5457458544503613</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.9948297423459715</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0568231573982978</span><span class="p">,</span><span class="w"> </span><span class="mf">0.364541921538492</span><span class="p">,</span><span class="w"> </span><span class="mf">-3.031435348103529</span><span class="p">,</span><span class="w"> </span><span class="mf">6.525284759259127</span><span class="p">,</span><span class="w"> </span><span class="mf">-3.691141330603938</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.3520650564480912</span><span class="p">,</span><span class="w"> </span><span class="mf">2.3077796317190997</span><span class="p">,</span><span class="w"> </span><span class="mf">-4.679682723890192</span><span class="p">,</span><span class="w"> </span><span class="mf">2.7076975783555843</span><span class="p">],</span><span class="w"> 
  </span><span class="nl">"right_uv_to_rect_y"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">-0.37556223294961705</span><span class="p">,</span><span class="w"> </span><span class="mf">0.09788739182864804</span><span class="p">,</span><span class="w"> </span><span class="mf">0.20612688870797224</span><span class="p">,</span><span class="w"> </span><span class="mf">0.018202268047632426</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1512068570708922</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2696319130575867</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.35236717773941184</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3331241095814942</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.35968622664250754</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.3372985493324961</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0606222321031296</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.5205614601118577</span><span class="p">,</span><span class="w"> </span><span class="mf">0.29099806952268736</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0763539162733278</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2842991526147592</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1018878015082091</span><span class="p">]</span><span class="w">
</span><span class="p">}</span></code></pre></figure>
</div>

<h3 id="setting-environment-variables">Setting Environment Variables</h3>
<p>If you want <a href="https://monado.freedesktop.org/direct-mode.html" rel="external nofollow noopener" target="_blank">direct-mode</a>, you have to use an X11 compositor with Monado, its not currently supported on Wayland or Xwayland. That said, I wanted to use Wayland because <img class="emoji" title=":shrug:" alt=":shrug:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f937.png" height="20" width="20">, I‚Äôm also used to extended-mode from the Unity Windows workflow so lack of direct-mode doesn‚Äôt bother me right now. Either way, you will need to set the following Monado environment variables in your shell configuration file, this guide assumes <code class="language-plaintext highlighter-rouge">zsh</code>, and therfore <code class="language-plaintext highlighter-rouge">~/.zshrc</code>. Feel free to add them with this command:</p>
<div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'
export NS_CONFIG_PATH=~/.config/monado/NorthStarCalibration.json # Set path to North Star calibration file.
export XRT_COMPOSITOR_DISABLE_DEFERRED=true # Keep Monado open even if no apps running.
export XRT_COMPOSITOR_FORCE_XCB=1 # Force an X11 window, thus causing Xwayland.
export XRT_COMPOSITOR_XCB_FULLSCREEN=1 # Fullscreen variable for X11/Xwayland.
'</span> <span class="o">&gt;&gt;</span> ~/.zshrc <span class="o">&amp;&amp;</span> <span class="nb">exec </span>zsh
</code></pre></div></div>
<p><br></p>

<h2 id="getting-started">Getting Started</h2>
<hr>

<h3 id="hardware">Hardware</h3>
<ol>
  <li>Plug in your North Star via USB 2.0 (either use a hub or a motherboard port, depending on whether or not you have a 2.0 port). Using Ultraleap devices through USB 3 on Linux is not currently supported due to driver shenanigans. <a href="https://discord.com/channels/994213697490800670/1061452346686713957/1062331957456928848" rel="external nofollow noopener" target="_blank">Source: <img src="/assets/img/monado-discord.png">  <img id="emoji" src="/assets/img/emoji/discord.png"></a>
</li>
  <li>Plug in your North Star via DisplayPort to your graphics card.</li>
  <li>Force <code class="language-plaintext highlighter-rouge">portReset()</code> on your North Star, via holding down the circle and dot buttons for 5 seconds. This power cycles your USB 3 header sensors (Stereo IR 170 and Intel T261) and ensures that they enumerate properly.</li>
  <li>Check that the sensors are working correctly
    <ol>
      <li>Run RealSense Viewer and check that the T261 is listed under sources.</li>
      <li>Run Ultraleap Control Panel and verify that the camera feed is being received.</li>
      <li>Close both.</li>
    </ol>
  </li>
</ol>

<p><br></p>

<h3 id="starting-monado">Starting Monado</h3>
<ol>
  <li>Run <code class="language-plaintext highlighter-rouge">monado-service</code>. If all goes well, you should be greeted with an output log that mentions your NorthStarCalibration.json being read. Look for  <code class="language-plaintext highlighter-rouge">INFO [p_create_system] Creating system:</code>, specifically the lines:
    <div class="language-plaintext highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>Got devices:
	0: Intel RealSense Device-SLAM
	1: North Star
</code></pre></div>    </div>
  </li>
  <li>A grey, fullscreen Xwayland Monado window should open on your main display.</li>
  <li>Move it to your North Star display, e.g by using the Kwin shortcut <code class="language-plaintext highlighter-rouge">Meta-Shift-right</code>
</li>
  <li>Congratulations, you win <img class="emoji" title=":tada:" alt=":tada:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png" height="20" width="20">
</li>
  <li>You can check Monado has access to your sensors by running a demo.</li>
  <li>Open a new terminal, download this simple <a href="https://gitlab.freedesktop.org/monado/demos/openxr-simple-playground" rel="external nofollow noopener" target="_blank">demo</a>, enter the directory, make and run the demo with:
    <div class="language-zsh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git clone https://gitlab.freedesktop.org/monado/demos/openxr-simple-playground <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cd </span>openxr-simple-playground <span class="o">&amp;&amp;</span> <span class="se">\ </span>
cmake ./ <span class="o">&amp;&amp;</span> <span class="se">\</span>
make <span class="o">&amp;&amp;</span> <span class="se">\</span>
./openxr-playground
</code></pre></div>    </div>
  </li>
  <li>You should have hand and 6DoF tracking working. Congratulations, you won again <img class="emoji" title=":tada:" alt=":tada:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png" height="20" width="20">
</li>
</ol>

<p><br></p>

<h2 id="uploading-integrator-sketches">Uploading Integrator Sketches</h2>
<hr>
<ol>
  <li>Download the Linux compatible <code class="language-plaintext highlighter-rouge">North-Star-Integrator</code> <a href="https://github.com/sambilbow/North-Star-Integrator/tree/master/firmware/ExampleSketches" rel="external nofollow noopener" target="_blank">sketches</a>:
    <div class="language-zsh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>git clone https://github.com/sambilbow/North-Star-Integrator.git <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cd </span>North-Star-Integrator/firmware/ExampleSketches
</code></pre></div>    </div>
  </li>
  <li>You may have to add yourself to the usergroup that <code class="language-plaintext highlighter-rouge">/dev/ttyACM0</code> (the Arduino Leonardo‚Äôs serial port) is part of if you are receiving errors uploading sketches.
    <ol>
      <li>Run <code class="language-plaintext highlighter-rouge">stat /dev/ttyACM0</code> in a terminal</li>
      <li>Note the user group that the serial port is assigned to, e.g. <code class="language-plaintext highlighter-rouge">dialout</code> or <code class="language-plaintext highlighter-rouge">plugdev</code>
</li>
      <li>Add your user to this group with <code class="language-plaintext highlighter-rouge">sudo usermod -a -G [group] [username]</code>
</li>
      <li>
<code class="language-plaintext highlighter-rouge">sudo</code> run command as superuser</li>
      <li>
<code class="language-plaintext highlighter-rouge">usermod</code> modify user attributes</li>
      <li>
<code class="language-plaintext highlighter-rouge">-a</code> append</li>
      <li>
<code class="language-plaintext highlighter-rouge">-G</code> group</li>
    </ol>
  </li>
  <li>Add the <code class="language-plaintext highlighter-rouge">../libraries/SX1508</code> folder to your Arduino library directory (default on Linux: <code class="language-plaintext highlighter-rouge">/home/[user]/Arduino/libraries</code>)
    <div class="language-zsh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> ~/Arduino/libraries <span class="o">&amp;&amp;</span> <span class="se">\</span>
<span class="nb">cp</span> ../libraries/SX1508 ~/Arduino/libraries/
</code></pre></div>    </div>
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">../libraries/SX1508/src/util/sx1508_registers.h</code> has been renamed to <code class="language-plaintext highlighter-rouge">SX1508_registers.h</code> in this repo because I was getting errors when I tried to access this file in the Arduino IDE on Linux, I believe this was because of <a href="https://en.wikipedia.org/wiki/Case_sensitivity" rel="external nofollow noopener" target="_blank">UNIX case-sensitivity</a>.</li>
    </ul>
  </li>
  <li>Open a sketch from the folder in Arduino IDE</li>
  <li>Install any additionally required libraries (on Linux I needed to add the <code class="language-plaintext highlighter-rouge">Keyboard</code> library)</li>
  <li>Set the correct Port and Board in <code class="language-plaintext highlighter-rouge">Tools &gt; </code>
</li>
  <li>Verify and Upload the sketch.</li>
</ol>

  </article>
</div>

    </div>

    <!-- Footer -->    <footer class="sticky-bottom mt-5">
      <div class="container">
        ¬© Copyright 2023 Sam  Bilbow. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>, and hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>.
Last updated: May 11, 2023.
      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
